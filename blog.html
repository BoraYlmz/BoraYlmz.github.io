<!DOCTYPE html>
<html lang="tr">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Bora Yılmaz</title>
  <link href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css" rel="stylesheet">
  <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css" rel="stylesheet">
  <script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>
  <style>
    #fixed-header {
      padding: 10px;
      border-bottom: 1px solid #ddd;
      position: sticky;
      top: 0;
      color: white;
      font-weight: bold;
      font-family: Arial, Helvetica, sans-serif;
      z-index: 10; 
    }
    .box {
      height: 100px;
      background-color: #484e53;
      color: white;
      margin: 10px 15px;
      padding-left: 25px;
      padding-right: 25px;
      position: relative;
    }
    .a,a:hover{
        text-decoration: none;
    }
    .text-area{
        display: -webkit-box;
        -webkit-line-clamp: 2;
        -webkit-box-orient: vertical;
        overflow: hidden;
        word-wrap: break-word;
        font-size: small;
        line-height: 1.6em;
    }
    .date-area{
        position: absolute;
        right: 5px; 
        width: auto; 
        bottom: 2px; 
        font-size: small;
    }
  </style>
</head>
<body class="d-flex bg-dark" style="height: 100vh; margin: 0;">
    <div class="col-3 bg-dark"></div>
    <div class="col-6"  >
        <div id="fixed-header" class="bg-dark">
            <div class="d-flex justify-content-between">
                <div style="font-size: 22px;">BORA YILMAZ</div>
                <div style="font-size: 18px;">Projects & Important Subjects</div>
            </div>
        </div>
        <div class="scroll-container" id="posts-container">
            <!-- İçerik kutuları -->
        </div>
    </div>
    <div class="col-3 bg-dark "></div>
    <script src="https://code.jquery.com/jquery-3.5.1.slim.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.9.3/dist/umd/popper.min.js"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js"></script>
       
       <script>
        // DOMContentLoaded olayı ile DOM yüklendikten sonra çalışması sağlanır.
        document.addEventListener('DOMContentLoaded', function () {
            const apiUrl = 'https://api.github.com/repos/BoraYlmz/boraylmz.github.io/contents/posts'; // GitHub API URL

            fetch(apiUrl)
                .then(response => {
                    if (!response.ok) {
                        throw new Error('GitHub API yanıtı başarısız: ' + response.status);
                    }
                    return response.json();
                })
                .then(files => {
                    const mdFiles = files.filter(file => file.name.endsWith('.md'));
                    let posts_container = document.getElementById('posts-container');
                    posts_container.innerHTML = '';  // Container'ı temizle
                    mdFiles.forEach(file => {
                        fetch(file.download_url)
                            .then(response => {
                                if (!response.ok) {
                                    throw new Error('Markdown dosyası alınamadı: ' + response.status);
                                }
                                return response.text();
                            })
                            .then(mdContent => {
                                const yamlRegex = /---\s*([\s\S]*?)\s*---/;
                                const match = mdContent.match(yamlRegex);
                                if (match) {
                                    const yamlContent = match[1].trim();
                                    const titleRegex = /Başlık:\s*"([^"]+)"/;
                                    const summaryRegex = /Özet:\s*"([^"]+)"/;
                                    const dateRegex = /Yazım Tarihi:\s*"([^"]+)"/;

                                    const titleMatch = yamlContent.match(titleRegex);
                                    const summaryMatch = yamlContent.match(summaryRegex);
                                    const dateMatch = yamlContent.match(dateRegex);

                                    const title = titleMatch ? titleMatch[1] : 'Başlık bulunamadı';
                                    const summary = summaryMatch ? summaryMatch[1] : 'Özet bulunamadı';
                                    const date = dateMatch ? dateMatch[1] : 'Tarih bulunamadı';
                                    // 
                                    const post = `<a href="blog-post.html" class="post-card" data-content="${file.name}">
                                                    <div class="box">
                                                        <div class="row"><h5>${title}</h5></div>
                                                        <div class="row text-area">${summary}</div>
                                                        <div class="container date-area">${date}</div>
                                                    </div>
                                                </a>`;

                                    posts_container.innerHTML += post;
                                } else {
                                    console.error('YAML front matter bulunamadı');
                                }
                            })
                            .catch(error => {
                                console.error('Markdown dosyası okunamadı:', error);
                            });
                    });

                    // Kartlara tıklama olayını ekliyoruz (Event Delegation)
                    posts_container.addEventListener('click', function (event) {
                        const card = event.target.closest('.post-card');
                        if (card) {
                            const mdContent = card.getAttribute('data-content');
                            console.log(mdContent)
                            // Markdown içeriğini localStorage'a kaydediyoruz
                            localStorage.setItem('mdContent', mdContent);
                        }
                    });
                })
                .catch(error => {
                    console.error('GitHub API hatası:', error);
                });
        });
    </script>
</body>
</html>
